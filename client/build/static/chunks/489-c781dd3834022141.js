"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[489],{1971:function(e,t,r){r.d(t,{Z:function(){return T}});var n=r(5893),o=r(7294),a=r(9521),i=r(7747),l=r(1136),s=r(1557),c=r(991),d=r(9840),u=r(510),h=r(4693),x=r(3717),m=r(5115),p=r(4698),g=r(1293),j=r(6948),y=r(6914),f=e=>{let{active:t,disabled:r,children:o,onClick:a}=e,i={bg:"brand.600",_dark:{bg:"brand.500"},color:"gray.200"};return(0,n.jsx)(y.m.button,{mx:1,px:4,py:2,rounded:"md",bg:"white",_dark:{bg:"gray.800"},color:"gray.700",onClick:a,opacity:r&&.6,_hover:!r&&i,cursor:r&&"not-allowed",disabled:r,...t&&i,children:o})},w=r(8193),v=r(6147),C=r(7640);let b={pageSize:20};var T=e=>{let{columns:t,data:r,isLoading:y,count:T=0,currentPage:k,onPageChange:S,onSortChange:D}=e,P=(0,o.useMemo)(()=>r,[r]),H=(0,o.useMemo)(()=>t,[t]),{getTableProps:F,getTableBodyProps:O,headers:E,rows:q,prepareRow:M,page:R,canPreviousPage:_,canNextPage:I,pageCount:W,pageOptions:N,gotoPage:B,state:{pageIndex:z,pageSize:L}}=(0,a.useTable)({columns:H,data:P,initialState:b,pageCount:T,manualPagination:!0,manualSortBy:!0,sortDescFirst:!0,defaultColumn:{width:"auto"}},a.useSortBy,a.usePagination);return(0,o.useEffect)(()=>{k!==z+1&&(B(0),S(1))},[k,z,S,B]),(0,n.jsxs)(n.Fragment,{children:[y?(0,n.jsx)(i.xu,{textAlign:"center",my:30,children:(0,n.jsx)(l.$,{thickness:"3px",speed:"0.65s",emptyColor:"gray.200",color:"blue.500",size:"xl"})}):(0,n.jsx)(s.x,{overflowX:"auto",overflowY:"auto",maxH:"75vh",borderWidth:1,children:(0,n.jsxs)(c.i,{layout:"fixed",variant:"simple",colorScheme:"gray",fontWeight:"300",...F(),children:[(0,n.jsx)(d.h,{backgroundColor:"gray.300",position:"sticky",top:0,zIndex:1,children:(0,n.jsx)(u.Tr,{children:E.map((e,t)=>(0,o.createElement)(h.Th,{...(e.getHeaderProps(e.getSortByToggleProps()),{style:{width:e.width,whiteSpace:"pre-line"}}),onClick:()=>D(e),key:t},(0,n.jsxs)(x.k,{alignItems:"center",children:[e.render("Header"),"asc"===e.sortDirection?(0,n.jsx)(v.v,{}):"desc"===e.sortDirection?(0,n.jsx)(C.g,{}):null]})))})}),(0,n.jsx)(m.p,{...O(),children:R.map((e,t)=>(M(e),(0,o.createElement)(u.Tr,{...e.getRowProps(),key:t},e.cells.map((e,t)=>(0,o.createElement)(p.Td,{...e.getCellProps({style:{width:e.column.width,whiteSpace:"pre-line"}}),key:t},e.render("Cell"))))))})]})}),(null==r?void 0:r.length)==0&&(0,n.jsx)(g.x,{my:4,textAlign:"center",fontWeight:"300",children:"No Data Found"}),(0,n.jsxs)(x.k,{p:5,w:"full",alignItems:"center",justifyContent:"space-between",flexDirection:{base:"column",md:"row"},children:[(0,n.jsx)(x.k,{children:(0,n.jsxs)(g.x,{fontWeight:"300",children:["Total of ",T," items"]})}),(0,n.jsxs)(x.k,{alignItems:"center",justifyContent:"center",children:[(0,n.jsx)(f,{onClick:()=>{if(_){let e=z>0?z-1:0;S(e+1),B(e)}},disabled:!_,children:(0,n.jsx)(j.J,{as:w.CF5,color:"gray.700",_dark:{color:"gray.200"},boxSize:4,disabled:!_})}),(0,n.jsx)(g.x,{fontWeight:"300",mx:5,children:y?"...":"Page ".concat(z+1," of ").concat(0===Math.ceil(T/L)?1:Math.ceil(T/L))}),(0,n.jsx)(f,{onClick:()=>{if(I){let e=z+1<W?z+1:z;S(e+1),B(e)}},disabled:z+1===Math.ceil(T/L),children:(0,n.jsx)(j.J,{as:w.Td4,color:"gray.700",_dark:{color:"gray.200"},boxSize:4})})]})]})]})}},2622:function(e,t){t.Z=(e,t)=>{if(e){let r=new Date().toISOString().slice(0,10),n=window.URL.createObjectURL(new Blob([e])),o=document.createElement("a");o.href=n,o.setAttribute("download","".concat(t,"_").concat(r,".xlsx")),document.body.appendChild(o),o.click(),setTimeout(()=>{document.body.removeChild(o),window.URL.revokeObjectURL(n)},100)}}},5130:function(e,t,r){r.d(t,{L:function(){return n}});let n=e=>{var t;let{...r}=e,n={...r,...(null==r?void 0:r.page)&&{page:null==r?void 0:null===(t=r.page)||void 0===t?void 0:t.toString()}},o="?"+new URLSearchParams(n).toString();return o}},4123:function(e,t,r){r.r(t);var n=r(5893),o=r(967),a=r(7191),i=r(151),l=r(9993),s=r(4325),c=r(6083),d=r(1293),u=r(3717),h=r(6479),x=r(2167);r(7294);var m=r(8193);t.default=e=>{let{filters:t,setFilters:r}=e,{onOpen:p,onClose:g,isOpen:j}=(0,o.q)();return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(a.J,{isOpen:j,onOpen:p,onClose:g,placement:"top-end",closeOnBlur:!1,children:[(0,n.jsx)(i.x,{children:(0,n.jsx)(l.h,{colorScheme:"teal",variant:"outline","aria-label":"",icon:(0,n.jsx)(m.FNs,{})})}),(0,n.jsxs)(s.y,{p:5,children:[(0,n.jsx)(c.u,{}),(0,n.jsx)(d.x,{fontWeight:"500",mb:4,children:"Date Filter"}),(0,n.jsxs)(u.k,{alignItems:"flex-start",justifyContent:"space-between",flexDirection:"column",children:[(0,n.jsxs)(u.k,{alignItems:"center",mb:4,children:[(0,n.jsx)(d.x,{fontWeight:"300",mr:4,children:"From"}),(0,n.jsx)(h.I,{value:t.startDate||"",onChange:e=>r({...t,page:1,startDate:e.target.value?(0,x.Z)(new Date(e.target.value),"yyyy-MM-dd"):""}),fontWeight:"300",type:"date",w:56})]}),(0,n.jsxs)(u.k,{alignItems:"center",children:[(0,n.jsx)(d.x,{fontWeight:"300",mr:9,children:"To"}),(0,n.jsx)(h.I,{value:t.endDate||"",onChange:e=>r({...t,page:1,endDate:e.target.value?(0,x.Z)(new Date(e.target.value),"yyyy-MM-dd"):""}),fontWeight:"300",type:"date",w:56})]})]})]})]})})}},5118:function(e,t,r){r.r(t);var n=r(5893),o=r(4225);r(7294);var a=r(8193);t.default=e=>{let{handleDownload:t}=e;return(0,n.jsxs)(o.z,{fontWeight:"300",variant:"outline",colorScheme:"teal",onClick:t,children:[(0,n.jsx)(a.r2j,{})," Export"]})}},9519:function(e,t,r){r.r(t);var n=r(5893),o=r(7294),a=r(1557),i=r(991),l=r(5115),s=r(510),c=r(4698),d=r(9521);t.default=e=>{let{columns:t,data:r}=e,u=(0,o.useMemo)(()=>r,[r]),h=(0,o.useMemo)(()=>t,[t]),{getTableProps:x,getTableBodyProps:m,headers:p,rows:g,prepareRow:j,page:y}=(0,d.useTable)({columns:h,data:u,defaultColumn:{width:"auto"}});return(0,n.jsx)(a.x,{overflowX:"auto",overflowY:"auto",maxH:"30vh",children:(0,n.jsx)(i.i,{layout:"fixed",variant:"simple",colorScheme:"gray",fontWeight:"300",...x(),children:(0,n.jsx)(l.p,{...m(),children:g.map((e,t)=>(j(e),(0,o.createElement)(s.Tr,{...e.getRowProps(),key:t},e.cells.map((e,t)=>(0,o.createElement)(c.Td,{...e.getCellProps({style:{width:e.column.width,whiteSpace:"pre-line"}}),key:t},e.render("Cell"))))))})})})}},8489:function(e,t,r){r.r(t);var n=r(5893),o=r(1971),a=r(5130),i=r(4659),l=r(967),s=r(1293),c=r(3717),d=r(7294),u=r(2167),h=r(5580),x=r(333),m=r(2622),p=r(4123),g=r(5118);let j=e=>{let t=(0,u.Z)(new Date(e),"MMM dd, yyyy h:mma");return t};t.default=()=>{let[e,t]=(0,d.useState)(),[r,u]=(0,d.useState)({page:1,limit:20}),[y,f]=(0,d.useState)({sortDirection:"none",accessor:"",direction:""}),w=(0,a.L)({...r}),{data:v,refetch:C,isFetching:b,isLoading:T}=(0,i.pb)(w),[k]=(0,x.gq)(),S=async()=>{try{let{data:e}=await k({data:null==v?void 0:v.transactionHistory,query:w});(0,m.Z)(e,"transaction_history")}catch(e){console.log("Error",e)}},{isOpen:D,onClose:P,onOpen:H}=(0,l.q)(),F=[{Header:"TRN",accessor:"transactionSku",width:150,sortDirection:"transactionSku"===y.accessor?y.direction:"none"},{Header:"Item",accessor:"_id",width:150,Cell:e=>{let{cell:{row:t,value:r}}=e;return(0,n.jsxs)(s.x,{onClick:()=>O(r),cursor:"pointer",color:"teal",textDecor:"underline",children:["Sold (",t.original.cartData.length,")"]})}},{Header:"Total Price",accessor:"totalPrice",width:150,Cell:e=>{let{cell:{value:t}}=e,r=parseFloat(t).toFixed(2);return(0,n.jsx)(s.x,{children:"₱"+r})},sortDirection:"totalPrice"===y.accessor?y.direction:"none"},{Header:"Cash",accessor:"paymentReceived",width:150,sortDirection:"paymentReceived"===y.accessor?y.direction:"none",Cell:e=>{let{cell:{value:t}}=e,r=parseFloat(t).toFixed(2);return(0,n.jsx)(s.x,{children:"₱"+r})}},{Header:"Change",accessor:"paymentChange",width:150,sortDirection:"paymentChange"===y.accessor?y.direction:"none",Cell:e=>{let{cell:{value:t}}=e,r=parseFloat(t).toFixed(2);return(0,n.jsx)(s.x,{children:"₱"+r})}},{Header:()=>(0,n.jsx)(s.x,{children:"Cashier"}),accessor:"cashierName",width:120,Cell:e=>{let{cell:{value:t}}=e;return(0,n.jsx)(s.x,{children:t||"-"})},sortDirection:"cashierName"===y.accessor?y.direction:"none"},{Header:()=>(0,n.jsx)(s.x,{children:"Customer"}),accessor:"customerName",width:120,Cell:e=>{let{cell:{value:t}}=e;return(0,n.jsx)(s.x,{children:t||"-"})},sortDirection:"customerName"===y.accessor?y.direction:"none"},{Header:()=>(0,n.jsx)(s.x,{children:"Purchase Date"}),accessor:"createdAt",width:150,Cell:e=>{let{cell:{value:t}}=e;return(0,n.jsx)(s.x,{children:j(t)})},sortDirection:"createdAt"===y.accessor?y.direction:"none"}],O=e=>{let r=null==v?void 0:v.transactionHistory.find(t=>t._id===e);t(null==r?void 0:r.cartData),H()};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(c.k,{mb:4,alignItems:"center",justifyContent:"space-between",children:[(0,n.jsx)(g.default,{handleDownload:S}),(0,n.jsx)(p.default,{filters:r,setFilters:u})]}),(0,n.jsx)(o.Z,{columns:F,data:(null==v?void 0:v.transactionHistory)||[],count:null==v?void 0:v.count,isLoading:T,currentPage:null==r?void 0:r.page,onPageChange:e=>{u({...r,page:e}),C()},onSortChange:e=>{switch(e.sortDirection){case"none":f({direction:"asc",accessor:e.id}),u({...r,sortBy:e.id,sortOrder:"asc"});break;case"asc":f({direction:"desc",accessor:e.id}),u({...r,sortBy:e.id,sortOrder:"desc"});break;case"desc":f({direction:"none",accessor:e.id}),u({...r,sortBy:"",sortOrder:""})}}}),(0,n.jsx)(h.default,{isOpen:D,onClose:P,productData:e})]})}},5580:function(e,t,r){r.r(t);var n=r(5893),o=r(1293),a=r(5541),i=r(9778),l=r(4581),s=r(4859),c=r(6205),d=r(4346),u=r(4253),h=r(4225),x=r(9519);t.default=e=>{let{isOpen:t,onClose:r,productData:m}=e;return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(a.u_,{size:"xl",isCentered:!0,onClose:r,isOpen:t,motionPreset:"slideInBottom",children:[(0,n.jsx)(i.Z,{}),(0,n.jsxs)(l.h,{children:[(0,n.jsx)(s.x,{fontWeight:"300",children:"Product sold"}),(0,n.jsx)(c.o,{}),(0,n.jsx)(d.f,{children:(0,n.jsx)(x.default,{columns:[{Header:"SKU",accessor:"sku",width:150},{Header:"Name",accessor:"name",width:150},{Header:()=>(0,n.jsx)(o.x,{children:"Price per unit"}),accessor:"price",width:150,Cell:e=>{let{cell:{value:t}}=e,r=parseFloat(t).toFixed(2);return(0,n.jsx)(o.x,{children:"₱"+r})}},{Header:"Unit",accessor:"unit",width:100},{Header:()=>(0,n.jsx)(o.x,{children:"Qty"}),accessor:"quantity",width:80,Cell:e=>{let{cell:{value:t}}=e;return(0,n.jsxs)(o.x,{children:["x",t]})}},{Header:()=>(0,n.jsx)(o.x,{children:"Total"}),accessor:"total",width:150,Cell:e=>{let{cell:{value:t}}=e,r=parseFloat(t).toFixed(2);return(0,n.jsx)(o.x,{children:"₱"+r})}}],data:m})}),(0,n.jsx)(u.m,{children:(0,n.jsx)(h.z,{onClick:r,variant:"outline",colorScheme:"teal",children:"Close"})})]})]})})}},333:function(e,t,r){r.d(t,{gq:function(){return l},tu:function(){return i}});var n=r(9457);let o=n.h.injectEndpoints({endpoints:e=>({reportDownload:e.mutation({query:e=>({url:"file/report/download",method:"POST",responseType:"blob",data:e})}),reportProductSold:e.mutation({query:e=>{let{data:t,query:r}=e;return{url:"file/report/dlProductSoldReport".concat(r),method:"POST",responseType:"blob",data:t}},invalidatesTags:["Transaction"]}),reportTransactionHistory:e.mutation({query:e=>{let{data:t,query:r}=e;return{url:"file/report/dlTransactionHistoryReport".concat(r),method:"POST",responseType:"blob",data:t}},invalidatesTags:["Transaction"]})})}),{useReportDownloadMutation:a,useReportProductSoldMutation:i,useReportTransactionHistoryMutation:l}=o},4659:function(e,t,r){r.d(t,{Dx:function(){return a},F:function(){return l},pb:function(){return i}});var n=r(9457);let o=n.h.injectEndpoints({endpoints:e=>({createTransaction:e.mutation({query:e=>({url:"transaction/api/createTransaction",method:"POST",data:e}),invalidatesTags:["Transaction","Product"]}),getTransactionHistory:e.query({query:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return{url:"transaction/api/getTransactionHistory".concat(e),method:"GET"}},transformResponse:(e,t,r)=>e.data,providesTags:["Transaction"]}),getProductSold:e.query({query:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return{url:"transaction/api/getProductSold".concat(e),method:"GET"}},transformResponse:(e,t,r)=>e.data,providesTags:["Transaction"]})})}),{useCreateTransactionMutation:a,useGetTransactionHistoryQuery:i,useGetProductSoldQuery:l}=o}}]);